# WaterLens Lite 使用说明文档

WaterLens Lite 是一个基于 Flutter 开发的轻量级地下管线数据管理与核查工具，运行于 Windows 桌面端。本系统支持地图可视化、数据录入核查、多格式导入导出及回收站管理功能。

---

## 1. 核心功能概览

*   **地图可视化**：基于高德地图，直观展示管点分布，支持状态区分与交互。
*   **数据核查**：支持管点属性修改、图片采集，修改项自动高亮。
*   **数据管理**：提供列表视图、批量删除、回收站恢复功能。
*   **导入导出**：支持 GeoJSON、Excel、Markdown 等多种通用格式。

---

## 2. 详细操作指南

### 2.1 地图首页 (Map Page)

系统启动后默认进入地图页，展示兰州市及周边区域的管线点位。

#### **图例说明**
*   🟢 **绿色图标**：**已核查** 数据（Audit Status = 1）。
*   ⚪ **灰色图标**：**未核查** 数据（Audit Status = 0）。
*   🔵 **蓝色图标**：**新添加** 数据（24小时内手动创建），带有**弹性缩放动画**以突出显示。

#### **界面交互**
*   **鼠标坐标显示**：地图左下角实时显示当前鼠标悬停位置的 **经度** 和 **纬度**。
*   **UUID 标识**：每个点位图标下方显示其 UUID（唯一标识符）。
*   **悬停提示 (Tooltip)**：鼠标悬停在图标上时，显示“新添加”、“已核查”或“未核查”状态。
*   **点击进入**：点击任意点位图标，即可跳转至 **数据核查页** 进行编辑。

#### **功能按钮**
*   📍 **手动添加 (右下角 + 号)**：打开空白核查页，手动录入新点位。
*   📂 **数据导入 (右下角上传图标)**：支持导入 `.geojson`, `.xlsx`, `.md` 格式文件。
*   📝 **数据列表 (右上角列表图标)**：跳转至数据管理列表页面。

---

### 2.2 数据核查与录入 (Audit Page)

在此页面进行数据的查看、修改和新数据录入。

#### **数据编辑**
*   **UUID**：
    *   新建点位时自动生成（格式：`manual-时间戳`），支持手动修改。
    *   已有点位 UUID 不可修改。
*   **属性修改**：支持修改 类型、经度、纬度、埋深、材质 等属性。
*   **样式高亮**：凡是 **被修改过的数据项**（即与原始数据不一致），输入框文字会自动变为 **红色且加粗**，便于核查人员快速识别变更内容。

#### **图片管理**
*   支持点击相机图标进行 **拍照** 或 **选择本地图片**。
*   图片缩略图显示在属性表下方，支持删除。

#### **保存与删除**
*   **保存**：点击右上角“对号”按钮保存修改。若为新数据，会自动记录创建时间（用于地图页蓝色高亮显示）。
*   **删除**：点击右上角“垃圾桶”按钮，将数据移入回收站（软删除）。

---

### 2.3 数据管理 (Data Management)

通过地图页右上角按钮进入，以表格形式展示所有有效数据。

#### **列表功能**
*   **查看详情**：点击列表项可跳转至核查页。
*   **批量删除**：勾选多条数据后，点击底部“删除”按钮放入回收站。

#### **数据导出**
*   点击右上角 **“导出”** 按钮。
*   **支持格式**：JSON, GeoJSON, Excel (.xlsx), Markdown (.md)。
*   **导出逻辑**：系统优先导出 **核查后（修改后）** 的数据。如果某字段未修改，则导出原始值。

#### **回收站 (Recycle Bin)**
*   点击右上角 **“回收站”** 菜单进入。
*   **恢复**：将误删数据恢复至正常列表。
*   **彻底删除**：从数据库中永久移除数据。

---

## 3. 技术特性与说明

*   **调试模式**：已关闭 Flutter 默认的 DEBUG 标签，提供干净的界面体验。
*   **数据存储**：使用本地 SQLite 数据库 (Drift)，无需联网即可保存数据。
*   **图片存储**：图片文件保存在应用本地数据目录下。
*   **地图源**：内置高德地图瓦片源，确保国内网络环境加载流畅。

---

> 文档生成日期：2026-01-11
